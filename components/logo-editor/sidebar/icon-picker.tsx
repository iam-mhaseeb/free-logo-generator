"use client";

import { ScrollArea } from "@/components/ui/scroll-area";
import { Input } from "@/components/ui/input";
import { useLogoEditor } from "../logo-editor-context";
import { useState, useMemo, useCallback } from "react";
import dynamic from "next/dynamic";

// List of famous icons to be pre-loaded
const famousIcons = [
  { name: "Search", Icon: dynamic(() => import('lucide-react').then((module) => module.Search)) },
  { name: "Heart", Icon: dynamic(() => import('lucide-react').then((module) => module.Heart)) },
  { name: "Star", Icon: dynamic(() => import('lucide-react').then((module) => module.Star)) },
  { name: "User", Icon: dynamic(() => import('lucide-react').then((module) => module.User)) },
  { name: "Home", Icon: dynamic(() => import('lucide-react').then((module) => module.Home)) },
  { name: "Camera", Icon: dynamic(() => import('lucide-react').then((module) => module.Camera)) },
  { name: "Bell", Icon: dynamic(() => import('lucide-react').then((module) => module.Bell)) },
  { name: "Folder", Icon: dynamic(() => import('lucide-react').then((module) => module.Folder)) },
  { name: "FileText", Icon: dynamic(() => import('lucide-react').then((module) => module.FileText)) },
  { name: "Settings", Icon: dynamic(() => import('lucide-react').then((module) => module.Settings)) },
];

export function IconPicker() {
  const { updateState } = useLogoEditor();
  const [search, setSearch] = useState("");
  const [dynamicIcons, setDynamicIcons] = useState<{ name: string; Icon: React.ComponentType<any> }[]>([]);

  // Dynamically load icons based on the search term
  const loadDynamicIcons = useCallback(async (searchTerm: string) => {
    if (searchTerm) {
      try {
        debugger;
        // Dynamically import icons based on the search term
        const iconNames = [
          'FileClock', 'ChevronsUp', 'CornerLeftDown', 'Gitlab', 'NotepadText', 'PaintRoller', 'SquareArrowOutDownRight', 'FlaskConicalOff', 'Link', 'FileAudio2', 'PanelBottomClose', 'MoveHorizontal', 'Bomb', 'SlidersHorizontal', 'Video', 'ArrowBigUp', 'MailPlus', 'ArrowDown01', 'Ampersands', 'ListChecks', 'Compass', 'BrainCircuit', 'Maximize2', 'ThermometerSnowflake', 'FolderTree', 'Binary', 'Tally3', 'Telescope', 'Diff', 'Milestone', 'WheatOff', 'Ambulance', 'BellMinus', 'WholeWord', 'Brush', 'GalleryVertical', 'FolderPlus', 'AlignVerticalJustifyCenter', 'BriefcaseBusiness', 'Calculator', 'ClipboardPaste', 'SquareArrowUp', 'Axis3d', 'TicketPercent', 'ArrowUpZA', 'Archive', 'SquareActivity', 'SquareChevronLeft', 'FastForward', 'Eraser', 'Tally1', 'Plus', 'Clock9', 'AlignCenterHorizontal', 'Cast', 'Clock6', 'FireExtinguisher', 'Crop', 'BadgeEuro', 'Bandage', 'Merge', 'Droplet', 'Tags', 'ZoomOut', 'SquareUser', 'Component', 'CaptionsOff', 'FolderOpen', 'SquareArrowOutUpLeft', 'SquareChartGantt', 'Lectern', 'Crosshair', 'CalendarSync', 'AlignVerticalSpaceAround', 'Pencil', 'SearchCode', 'TableOfContents', 'MailMinus', 'LockOpen', 'MessageCircleReply', 'Hospital', 'HandCoins', 'SquareSigma', 'Settings2', 'MemoryStick', 'MonitorSpeaker', 'BookUser', 'CircleAlert', 'FileAudio', 'SquareParkingOff', 'WrapText', 'Radar', 'Barcode', 'FileJson2', 'PaintbrushVertical', 'ServerCrash', 'Meh', 'Check', 'Watch', 'Grid2x2X', 'CakeSlice', 'Tractor', 'LocateFixed', 'Layers', 'GitPullRequestArrow', 'FolderHeart', 'Music', 'PackageCheck', 'TreeDeciduous', 'Shield', 'FolderPen', 'ChartNoAxesColumnIncreasing', 'ConciergeBell', 'Italic', 'Radical', 'AlignStartVertical', 'RotateCwSquare', 'BluetoothOff', 'Clock7', 'CaseLower', 'WavesLadder', 'PlaneLanding', 'ChartColumnBig', 'PhoneIncoming', 'Sigma', 'RussianRuble', 'Axe', 'BriefcaseMedical', 'Columns4', 'LogIn', 'SquareMenu', 'Dice2', 'Film', 'ListFilterPlus', 'Nut', 'Grape', 'BookUp2', 'Sunrise', 'Turtle', 'TypeOutline', 'ListStart', 'Bold', 'OctagonPause', 'Smartphone', 'TableCellsMerge', 'GripHorizontal', 'ScanHeart', 'SquareSquare', 'CloudDrizzle', 'GitPullRequestClosed', 'SaveAll', 'LaptopMinimal', 'Server', 'Dice6', 'ChevronFirst', 'TicketSlash', 'Move3d', 'EqualApproximately', 'BadgeX', 'ParkingMeter', 'AlignHorizontalDistributeEnd', 'Braces', 'Bitcoin', 'ChartColumnStacked', 'DropletOff', 'CircleDashed', 'ScanFace', 'ChartNoAxesCombined', 'TrafficCone', 'MessageSquareCode', 'ChartNoAxesColumnDecreasing', 'MessageSquareQuote', 'Camera', 'Mountain', 'File', 'SaveOff', 'UndoDot', 'Power', 'CalendarArrowUp', 'Clock8', 'MessageCircleDashed', 'FileMinus2', 'PanelRightDashed', 'UserPen', 'BugPlay', 'PinOff', 'RotateCcw', 'TableProperties', 'Unlink', 'AlarmClockPlus', 'GalleryHorizontal', 'CircleHelp', 'BadgeHelp', 'ReceiptEuro', 'Option', 'PillBottle', 'Apple', 'SignalMedium', 'MapPinX', 'ChartScatter', 'FolderOutput', 'Milk', 'HousePlug', 'PanelRightClose', 'SearchX', 'PanelBottomDashed', 'Club', 'ReceiptPoundSterling', 'CassetteTape', 'Grid2x2', 'Key', 'FileType2', 'Package', 'SmilePlus', 'Bus', 'Airplay', 'DollarSign', 'PiggyBank', 'LockKeyholeOpen', 'Umbrella', 'Tablets', 'FlagTriangleLeft', 'Bed', 'SquareArrowOutUpRight', 'LoaderCircle', 'CircleDot', 'Radius', 'MonitorCog', 'ArrowDownWideNarrow', 'LayoutTemplate', 'Euro', 'ReceiptJapaneseYen', 'Utensils', 'CircleDivide', 'Clock1', 'CalendarHeart', 'MousePointerClick', 'Image', 'MegaphoneOff', 'ListCollapse', 'MonitorPlay', 'Type', 'FlaskRound', 'Blend', 'Fan', 'Heading2', 'TicketX', 'Quote', 'GitMerge', 'TextQuote', 'OctagonX', 'Pocket', 'CirclePower', 'Ear', 'MoveRight', 'WebhookOff', 'GitCommitVertical', 'TvMinimal', 'FileJson', 'Users', 'ArrowDownToDot', 'SignalZero', 'CameraOff', 'ArrowDownRight', 'ClipboardList', 'Code', 'Square', 'RockingChair', 'Ungroup', 'AlignHorizontalJustifyEnd', 'Torus', 'CloudSnow', 'SquareArrowDownRight', 'PanelBottomOpen', 'Gavel', 'Sword', 'ReceiptText', 'CirclePlay', 'CircleArrowOutUpRight', 'SquareDot', 'Bone', 'ArrowUpFromDot', 'ImagePlus', 'TrainFrontTunnel', 'BookmarkCheck', 'Fence', 'ArrowBigLeftDash', 'RectangleEllipsis', 'FolderArchive', 'ImagePlay', 'FileMinus', 'Reply', 'AlignRight', 'Usb', 'EggFried', 'Subscript', 'Activity', 'ShieldQuestion', 'SignalLow', 'Mail', 'ListOrdered', 'LeafyGreen', 'FileOutput', 'SmartphoneCharging', 'WifiLow', 'SquareChevronDown', 'ScrollText', 'ArrowBigLeft', 'ShieldX', 'Eclipse', 'SquarePower', 'Sparkle', 'SignpostBig', 'Cuboid', 'User', 'Instagram', 'CandyCane', 'PackagePlus', 'ScissorsLineDashed', 'Waypoints', 'Volleyball', 'FileImage', 'Grab', 'CircleUser', 'HardDriveUpload', 'Hexagon', 'Binoculars', 'Popcorn', 'WineOff', 'CornerDownLeft', 'PanelTopDashed', 'Rocket', 'Framer', 'School', 'FolderMinus', 'NavigationOff', 'Percent', 'Languages', 'BicepsFlexed', 'Joystick', 'UnfoldVertical', 'BookX', 'ClipboardType', 'Pyramid', 'IdCard', 'Files', 'PhoneOff', 'ArrowUpLeft', 'Import', 'IterationCcw', 'MessageSquarePlus', 'Gift', 'Pin', 'LassoSelect', 'ArrowDown', 'ArrowUpWideNarrow', 'ChartBarStacked', 'Guitar', 'CloudFog', 'Circle', 'SendHorizontal', 'FileWarning', 'CircleChevronDown', 'ThermometerSun', 'Infinity', 'Siren', 'Facebook', 'Podcast', 'ScreenShareOff', 'BadgeCheck', 'LayoutGrid', 'Save', 'PhilippinePeso', 'Coins', 'HeartCrack', 'LayoutPanelLeft', 'Moon', 'Salad', 'SearchSlash', 'Heading3', 'WifiHigh', 'PanelsRightBottom', 'MapPinXInside', 'AlignHorizontalJustifyStart', 'Codepen', 'Disc', 'SquareUserRound', 'BadgePlus', 'Notebook', 'CarTaxiFront', 'FileUser', 'Rainbow', 'MoveVertical', 'Scale3d', 'ChartNoAxesColumn', 'Gauge', 'FlipVertical2', 'FolderSearch', 'MapPinCheck', 'GitBranchPlus', 'MoveUp', 'Menu', 'Bell', 'Mic', 'ArrowRightFromLine', 'Dumbbell', 'KeyRound', 'PhoneCall', 'BookOpenCheck', 'WindArrowDown', 'Inbox', 'SpellCheck', 'ClipboardCheck', 'Rss', 'PrinterCheck', 'TableColumnsSplit', 'Ligature', 'LockKeyhole', 'TreePine', 'Rows2', 'Armchair', 'ToggleRight', 'ZoomIn', 'ToyBrick', 'Split', 'BookOpen', 'Clock3', 'LampWallDown', 'PanelTop', 'ReceiptIndianRupee', 'SunDim', 'BeerOff', 'CircleChevronUp', 'Folder', 'Hourglass', 'PenLine', 'PointerOff', 'IterationCw', 'Redo', 'Navigation', 'Sailboat', 'WashingMachine', 'BookmarkX', 'FileType', 'Cog', 'CircleFadingPlus', 'Navigation2', 'Rotate3d', 'BetweenVerticalEnd', 'CreativeCommons', 'TrainTrack', 'ScanEye', 'Images', 'ArrowUpFromLine', 'Contact', 'FoldVertical', 'Trophy', 'Equal', 'ArrowDown10', 'CloudUpload', 'FileDigit', 'AlignEndHorizontal', 'Volume', 'UserRoundPlus', 'Box', 'Forward', 'RotateCcwSquare', 'Flashlight', 'ChevronsRightLeft', 'FileX', 'ClockArrowDown', 'ChartBar', 'LayoutPanelTop', 'Heading1', 'CalendarPlus', 'SquareChevronUp', 'CalendarRange', 'HandHelping', 'Castle', 'Heading6', 'CopyMinus', 'Fish', 'Pi', 'Building', 'ChevronDown', 'SquareKanban', 'Cigarette', 'Triangle', 'Scroll', 'SwissFranc', 'Bug', 'Cookie', 'Asterisk', 'Dice1', 'AlignVerticalJustifyEnd', 'View', 'BadgeAlert', 'BookHeart', 'SprayCan', 'GitCompare', 'MessageSquareDiff', 'Luggage', 'DoorOpen', 'BadgeCent', 'SunMoon', 'Computer', 'Figma', 'DatabaseBackup', 'Gamepad2', 'OctagonMinus', 'BetweenHorizontalEnd', 'Donut', 'SquareTerminal', 'PocketKnife', 'TableRowsSplit', 'Cake', 'SquareDashedBottomCode', 'Landmark', 'BetweenHorizontalStart', 'House', 'Diamond', 'BadgePercent', 'Lightbulb', 'Refrigerator', 'Palette', 'Sticker', 'UnfoldHorizontal', 'DraftingCompass', 'Wallet', 'ArrowDownZA', 'EarthLock', 'Repeat2', 'Signpost', 'CircleUserRound', 'MousePointer2', 'Tangent', 'MonitorOff', 'SatelliteDish', 'ArrowBigUpDash', 'CloudOff', 'CandyOff', 'ArrowBigDown', 'CircleOff', 'MapPinOff', 'JapaneseYen', 'CirclePlus', 'Grip', 'ChevronRight', 'SquareArrowDown', 'Workflow', 'HopOff', 'Slice', 'FileLock', 'Pause', 'MessageCirclePlus', 'Snail', 'Rat', 'Shell', 'TowerControl', 'MoveDiagonal', 'ScreenShare', 'SquareArrowOutDownLeft', 'Soup', 'MessageSquare', 'ClipboardPen', 'RemoveFormatting', 'KeySquare', 'OctagonAlert', 'MailSearch', 'MailWarning', 'CloudMoonRain', 'Squirrel', 'BadgeIndianRupee', 'BadgePoundSterling', 'SquareSplitHorizontal', 'Newspaper', 'Ham', 'Backpack', 'MessageCircleOff', 'CupSoda', 'Maximize', 'FlaskConical', 'UtensilsCrossed', 'EyeClosed', 'Dog', 'ArrowDownNarrowWide', 'ArrowLeftFromLine', 'PlaneTakeoff', 'Frame', 'CircleDollarSign', 'Sheet', 'Wallpaper', 'BookUp', 'Hand', 'FishSymbol', 'Touchpad', 'Brackets', 'ListVideo', 'AlignHorizontalDistributeStart', 'CirclePercent', 'Phone', 'CreditCard', 'BellElectric', 'Dock', 'FolderCheck', 'Album', 'Monitor', 'FolderSearch2', 'BadgeInfo', 'UtilityPole', 'Speaker', 'GitPullRequestDraft', 'Tv', 'ShieldOff', 'Folders', 'ChartBarBig', 'FileVideo2', 'DatabaseZap', 'GitFork', 'CalendarOff', 'Puzzle', 'Clock2', 'ImageUp', 'PawPrint', 'ReceiptCent', 'CircleArrowUp', 'PanelLeftOpen', 'Truck', 'Network', 'Waves', 'SquareArrowUpLeft', 'MoonStar', 'FileChartPie', 'GitCompareArrows', 'PanelLeftClose', 'Database', 'Recycle', 'Beef', 'Signature', 'UserSearch', 'CircleChevronLeft', 'Tickets', 'QrCode', 'FolderClosed', 'Ampersand', 'Clock11', 'Router', 'Download', 'FileUp', 'Search', 'BookCheck', 'Worm', 'Haze', 'BookMarked', 'UserX', 'Repeat', 'CircleGauge', 'Book', 'PackageOpen', 'TicketCheck', 'Contrast', 'HandMetal', 'CornerRightUp', 'Toilet', 'BrickWall', 'CircleArrowOutDownRight', 'Scissors', 'Navigation2Off', 'PanelsTopLeft', 'AlignEndVertical', 'Atom', 'AArrowUp', 'MapPinPlus', 'Rabbit', 'ShieldPlus', 'CalendarX2', 'UserRoundX', 'TextSearch', 'MailCheck', 'Baby', 'ReceiptSwissFranc', 'ChartColumn', 'Dna', 'MousePointerBan', 'Swords', 'Feather', 'CalendarCog', 'SquareMousePointer', 'University', 'SignalHigh', 'MessageSquareReply', 'Clock', 'ShipWheel', 'WalletCards', 'CalendarMinus', 'ArrowDownLeft', 'GitPullRequestCreate', 'Minus', 'Sunset', 'BadgeJapaneseYen', 'ReplyAll', 'AppWindowMac', 'ClockArrowUp', 'ShieldAlert', 'Logs', 'Headphones', 'Squircle', 'MessageCircleQuestion', 'MouseOff', 'CircleParking', 'CopyPlus', 'Wand', 'Car', 'Unlink2', 'Battery', 'RailSymbol', 'CableCar', 'PanelLeftDashed', 'Warehouse', 'Orbit', 'CircleArrowOutUpLeft', 'FileText', 'Repeat1', 'PanelTopClose', 'Clipboard', 'FileKey', 'ALargeSmall', 'Sprout', 'Grid2x2Check', 'Forklift', 'BatteryLow', 'MoveUpRight', 'Microscope', 'Copyleft', 'UserRoundMinus', 'ArrowRightToLine', 'MonitorCheck', 'Factory', 'SunMedium', 'Music2', 'Goal', 'PhoneForwarded', 'Cctv', 'ScanText', 'AlignVerticalJustifyStart', 'Share2', 'Settings', 'Dice3', 'Banana', 'PlugZap', 'Cross', 'Info', 'ArrowUp10', 'BookAudio', 'BadgeMinus', 'Amphora', 'UserRoundPen', 'Citrus', 'Crown', 'KeyboardMusic', 'BugOff', 'SquareArrowRight', 'FileKey2', 'CalendarCheck', 'Snowflake', 'FileBadge', 'FolderRoot', 'Cloud', 'SquareEqual', 'TicketPlus', 'SquareArrowDownLeft', 'SquareParking', 'ArrowUpToLine', 'ExternalLink', 'Linkedin', 'MessageSquareText', 'Smile', 'SquarePi', 'Gamepad', 'HeartPulse', 'ReplaceAll', 'MicOff', 'Piano', 'CalendarFold', 'FolderGit2', 'Dice4', 'Rows4', 'Flower', 'BookText', 'LaptopMinimalCheck', 'Martini', 'SquareCheckBig', 'BluetoothSearching', 'ContactRound', 'Glasses', 'ReceiptRussianRuble', 'ChartLine', 'UmbrellaOff', 'PencilOff', 'AlignHorizontalSpaceAround', 'PilcrowLeft', 'Superscript', 'ListTree', 'IndentIncrease', 'Trash', 'Trees', 'PictureInPicture', 'BedDouble', 'Heading5', 'TicketMinus', 'ArrowLeft', 'ClipboardX', 'Hotel', 'Fingerprint', 'GitBranch', 'MessageCircleCode', 'Weight', 'Strikethrough', 'ArchiveX', 'Drill', 'FlagOff', 'Kanban', 'Lasso', 'Tally2', 'BringToFront', 'IceCreamCone', 'Speech', 'Undo', 'Candy', 'HeartOff', 'GlassWater', 'FileMusic', 'Octagon', 'SwitchCamera', 'ChartBarIncreasing', 'AlarmClockOff', 'CircleArrowRight', 'MessageSquareMore', 'Section', 'FileChartColumn', 'FolderX', 'ChartNoAxesGantt', 'BadgeRussianRuble', 'MessageCircleWarning', 'BotMessageSquare', 'Laptop', 'KeyboardOff', 'ToggleLeft', 'ArrowDownUp', 'PencilRuler', 'Omega', 'Keyboard', 'Bookmark', 'SquarePen', 'Ruler', 'MapPinHouse', 'Locate', 'Scaling', 'MapPinned', 'VideoOff', 'SquareRadical', 'FileVolume2', 'Group', 'FileCheck2', 'RotateCw', 'MessageSquareWarning', 'FileBadge2', 'MoveLeft', 'SquareSlash', 'Chrome', 'Egg', 'MapPinMinus', 'PhoneMissed', 'MapPinCheckInside', 'Twitter', 'Shrub', 'ChevronsLeft', 'FileCode2', 'BriefcaseConveyorBelt', 'Variable', 'Package2', 'TrainFront', 'Star', 'SquareLibrary', 'Webhook', 'Church', 'FilePlus', 'AlignJustify', 'FlipHorizontal2', 'Drama', 'Shuffle', 'GitPullRequest', 'Syringe', 'WifiOff', 'ShowerHead', 'Loader', 'Origami', 'PanelsLeftBottom', 'Croissant', 'SquareBottomDashedScissors', 'FolderCode', 'MilkOff', 'Pipette', 'Badge', 'Pill', 'CircuitBoard', 'Lamp', 'PanelRightOpen', 'SquarePercent', 'ServerOff', 'UserCheck', 'ChevronUp', 'Hash', 'ListX', 'GraduationCap', 'ListFilter', 'Tablet', 'ShieldMinus', 'Bike', 'Wine', 'NotebookPen', 'Volume2', 'Carrot', 'List', 'PackageMinus', 'ScanLine', 'CornerRightDown', 'Award', 'MoveDownLeft', 'BookPlus', 'BrainCog', 'SquareArrowLeft', 'MoveDown', 'HardDrive', 'LoaderPinwheel', 'PaintBucket', 'Spade', 'HardHat', 'SquareDashedKanban', 'Dessert', 'BookDashed', 'LightbulbOff', 'CopyCheck', 'StickyNote', 'IndianRupee', 'DiamondMinus', 'Drum', 'ShoppingBag', 'Flag', 'Laugh', 'IndentDecrease', 'Blocks', 'LifeBuoy', 'SunSnow', 'Clover', 'BookKey', 'ChevronLast', 'CarFront', 'CloudSun', 'Wind', 'Dices', 'Satellite', 'Pen', 'FlagTriangleRight', 'ThumbsDown', 'TramFront', 'ShieldHalf', 'Gem', 'MessageCircleMore', 'Vegan', 'BusFront', 'ChartPie', 'ArrowUpRight', 'AtSign', 'CloudRainWind', 'ChefHat', 'ImageMinus', 'ListRestart', 'Aperture', 'Minimize2', 'FilePlus2', 'BookHeadphones', 'Sparkles', 'FishOff', 'HardDriveDownload', 'TextSelect', 'LayoutList', 'SquareDashed', 'Projector', 'LocateOff', 'AlignVerticalDistributeCenter', 'BadgeSwissFranc', 'ArrowUp01', 'ChartColumnDecreasing', 'BookType', 'SquareDashedBottom', 'CloudRain', 'CircleArrowDown', 'FolderClock', 'MonitorSmartphone', 'FlashlightOff', 'BedSingle', 'MessageCircleHeart', 'HandPlatter', 'ClipboardMinus', 'SwatchBook', 'Text', 'SquareArrowUpRight', 'Cylinder', 'ChartGantt', 'ListMinus', 'MonitorStop', 'Grid3x3', 'Captions', 'FileSearch2', 'Footprints', 'SquareChevronRight', 'MonitorDown', 'Clock12', 'AlignLeft', 'Dot', 'Printer', 'CircleParkingOff', 'AlignStartHorizontal', 'MailX', 'FolderUp', 'CloudAlert', 'WandSparkles', 'AppWindow', 'DiscAlbum', 'CircleArrowLeft', 'CloudHail', 'ArrowDownFromLine', 'Youtube', 'ChevronsDown', 'Paperclip', 'Briefcase', 'NotepadTextDashed', 'Rows3', 'MessageSquareLock', 'ServerCog', 'PartyPopper', 'TrendingDown', 'TimerOff', 'Tornado', 'GitPullRequestCreateArrow', 'BatteryCharging', 'FileLock2', 'FolderCog', 'NotebookTabs', 'Plug2', 'SendToBack', 'FolderDown', 'Grid2x2Plus', 'UserCog', 'Disc2', 'ShieldCheck', 'Pilcrow', 'Presentation', 'StretchVertical', 'Ellipsis', 'CircleEllipsis', 'CalendarX', 'Voicemail', 'AlignHorizontalSpaceBetween', 'BookmarkMinus', 'Mails', 'Drumstick', 'BookMinus', 'ListMusic', 'History', 'Trash2', 'ChartCandlestick', 'Cpu', 'FileHeart', 'MessageSquareOff', 'Shapes', 'Ticket', 'SkipForward', 'Beer', 'ShoppingCart', 'Undo2', 'Highlighter', 'LibraryBig', 'NotebookText', 'TestTubes', 'CircleCheck', 'Currency', 'FolderLock', 'BookLock', 'Shirt', 'CalendarDays', 'AlignHorizontalDistributeCenter', 'RectangleHorizontal', 'Boxes', 'FlipVertical', 'ArrowUpAZ', 'Layers2', 'Play', 'TextCursor', 'Vibrate', 'BookImage', 'Share', 'BluetoothConnected', 'FileCheck', 'Move', 'SquareDashedMousePointer', 'FolderSymlink', 'ScanQrCode', 'ChartColumnIncreasing', 'GalleryVerticalEnd', 'TouchpadOff', 'FileAxis3d', 'Ghost', 'SquarePilcrow', 'Store', 'MountainSnow', 'Calendar', 'ChartNetwork', 'PackageSearch', 'SquarePlus', 'Bolt', 'Sandwich', 'Wrench', 'MapPinMinusInside', 'MessageSquareDot', 'UserMinus', 'Dice5', 'Scale', 'LayoutDashboard', 'TabletSmartphone', 'BadgeDollarSign', 'ListCheck', 'CookingPot', 'CornerUpRight', 'SlidersVertical', 'ArrowLeftRight', 'Filter', 'FolderKey', 'Ribbon', 'Clock10', 'RectangleVertical', 'SquareX', 'Webcam', 'LogOut', 'ChartBarDecreasing', 'FileStack', 'DiamondPercent', 'Upload', 'SpellCheck2', 'Blinds', 'CalendarPlus2', 'TrendingUp', 'FileSearch', 'ImageOff', 'ChevronsLeftRight', 'PilcrowRight', 'BookA', 'Hammer', 'CloudLightning', 'RefreshCcwDot', 'Paintbrush', 'Accessibility', 'Dam', 'ListTodo', 'LampWallUp', 'Radio', 'IceCreamBowl', 'FilterX', 'HdmiPort', 'Zap', 'CornerLeftUp', 'AudioLines', 'SkipBack', 'SquarePlay', 'BookDown', 'MousePointer', 'Shrink', 'Lock', 'Biohazard', 'LampDesk', 'FolderSync', 'Heart', 'CircleDotDashed', 'MonitorX', 'Table', 'Nfc', 'CircleX', 'CloudSunRain', 'StarOff', 'BatteryWarning', 'CheckCheck', 'Construction', 'Mouse', 'BatteryFull', 'Unplug', 'CopySlash', 'SquareAsterisk', 'RefreshCwOff', 'CircleMinus', 'Megaphone', 'Signal', 'Slash', 'Send', 'VolumeOff', 'PersonStanding', 'TableCellsSplit', 'Flame', 'AudioWaveform', 'Link2Off', 'VolumeX', 'SmartphoneNfc', 'NutOff', 'Antenna', 'UserRoundSearch', 'Command', 'ArchiveRestore', 'Lollipop', 'PenOff', 'Building2', 'CigaretteOff', 'ClipboardPlus', 'CaseSensitive', 'PanelLeft', 'Cat', 'FileVideo', 'CalendarCheck2', 'AlignCenterVertical', 'Globe', 'Vote', 'FileArchive', 'FolderGit', 'EthernetPort', 'AlarmClockCheck', 'Ban', 'Timer', 'Hop', 'ArrowDownAZ', 'ShieldEllipsis', 'RadioTower', 'CircleSlash', 'RefreshCw', 'Vault', 'CalendarClock', 'CircleEqual', 'CopyX', 'FolderOpenDot', 'TreePalm', 'CircleStop', 'Clock4', 'BotOff', 'BookOpenText', 'Ratio', 'SeparatorVertical', 'LetterText', 'Ship', 'CloudMoon', 'Calendar1', 'MonitorPause', 'BookCopy', 'ShieldBan', 'LampFloor', 'Tag', 'Mailbox', 'FileDown', 'CaseUpper', 'StepForward', 'RefreshCcw', 'Expand', 'GalleryHorizontalEnd', 'AlignVerticalDistributeStart', 'BaggageClaim', 'Droplets', 'Disc3', 'FileVolume', 'TestTube', 'Headset', 'Cherry', 'GitCommitHorizontal', 'Radiation', 'PanelBottom', 'LampCeiling', 'FileTerminal', 'Banknote', 'Bird', 'Anchor', 'Pointer', 'RollerCoaster', 'StepBack', 'Anvil', 'Fullscreen', 'Eye', 'FolderDot', 'Baseline', 'Minimize', 'Target', 'Heater', 'Heading4', 'CloudCog', 'Proportions', 'ArrowDownToLine', 'ImageUpscale', 'CircleArrowOutDownLeft', 'Microchip', 'Link2', 'MoveDownRight', 'Divide', 'DiamondPlus', 'UserRoundCog', 'MessageSquareHeart', 'TriangleRight', 'ChevronsDownUp', 'MessageSquareX', 'FileSliders', 'Flower2', 'FlameKindling', 'RouteOff', 'TriangleAlert', 'FileX2', 'FileDiff', 'FileQuestion', 'Map', 'AArrowDown', 'ShoppingBasket', 'RadioReceiver', 'Delete', 'StarHalf', 'Plug', 'EllipsisVertical', 'SquareScissors', 'Diameter', 'Bot', 'Beaker', 'SquareSplitVertical', 'Trello', 'AlarmClock', 'MessageCircle', 'FileBox', 'CirclePause', 'FlipHorizontal', 'Angry', 'StretchHorizontal', 'ArrowUpDown', 'AlignVerticalSpaceBetween', 'SquareStack', 'SquareDivide', 'MoveUpLeft', 'DnaOff', 'ClipboardCopy', 'Videotape', 'FilePenLine', 'UsersRound', 'ClockAlert', 'TextCursorInput', 'Clock5', 'PoundSterling', 'BeanOff', 'Sofa', 'Combine', 'Twitch', 'Pizza', 'VenetianMask', 'FileSpreadsheet', 'Wifi', 'Coffee', 'Tent', 'PowerOff', 'Space', 'ThumbsUp', 'ZapOff', 'Handshake', 'ArrowLeftToLine', 'AlarmSmoke', 'Microwave', 'Library', 'Earth', 'TvMinimalPlay', 'UserRound', 'Frown', 'Rewind', 'GripVertical', 'SquareFunction', 'AlarmClockMinus', 'Terminal', 'Bean', 'EggOff', 'TimerReset', 'Cannabis', 'BetweenVerticalStart', 'MailOpen', 'Stethoscope', 'FerrisWheel', 'GitGraph', 'Wheat', 'PencilLine', 'EyeOff', 'Focus', 'Copyright', 'Music3', 'Plane', 'FolderKanban', 'Container', 'FilePen', 'LandPlot', 'BellRing', 'Cone', 'Tally5', 'Tally4', 'SeparatorHorizontal', 'TentTree', 'Popsicle', 'Replace', 'Parentheses', 'Copy', 'Brain', 'CornerDownRight', 'Music4', 'MoveDiagonal2', 'ChartSpline', 'WalletMinimal', 'Codesandbox', 'ArrowBigRightDash', 'RedoDot', 'Skull', 'Route', 'Shovel', 'Fuel', 'Columns3', 'MessageCircleX', 'FileCog', 'Spline', 'CircleFadingArrowUp', 'Scan', 'ChartArea', 'GlobeLock', 'ArrowBigDownDash', 'CircleSlash2', 'Cable', 'Columns2', 'HandHeart', 'MonitorUp', 'Leaf', 'PackageX', 'SquareM', 'CircleCheckBig', 'BellOff', 'ListEnd', 'SquareCheck', 'FileCode', 'FolderInput', 'PcCase', 'Heading', 'Magnet', 'ArrowUpNarrowWide', 'Pickaxe', 'CodeXml', 'TrendingUpDown', 'Bath', 'MessageSquareDashed', 'Table2', 'AlignCenter', 'Medal', 'Github', 'ScanBarcode', 'PhoneOutgoing', 'FileChartColumnIncreasing', 'MicVocal', 'GalleryThumbnails', 'SquareCode', 'CircleChevronRight', 'Annoyed', 'WifiZero', 'Clapperboard', 'TicketsPlane', 'MapPinPlusInside', 'Theater', 'CalendarMinus2', 'FileChartLine', 'Stamp', 'ArrowRight', 'PictureInPicture2', 'ImageDown', 'ListPlus', 'HeartHandshake', 'FileInput', 'VibrateOff', 'ArrowRightLeft', 'Volume1', 'HeadphoneOff', 'Caravan', 'ChevronLeft', 'Redo2', 'FileSymlink', 'MessageSquareShare', 'UserPlus', 'ChevronsRight', 'ScanSearch', 'PanelTopOpen', 'ChevronsUpDown', 'BellPlus', 'ChevronsLeftRightEllipsis', 'Bluetooth', 'DoorClosed', 'CloudDownload', 'ClipboardPenLine', 'AlignHorizontalJustifyCenter', 'AlignVerticalDistributeEnd', 'ArrowsUpFromLine', 'MessagesSquare', 'SearchCheck', 'CornerUpLeft', 'FileScan', 'Pentagon', 'UserRoundCheck', 'BellDot', 'HousePlus', 'Slack', 'Thermometer', 'Sun', 'PenTool', 'BookmarkPlus', 'BoomBox', 'Underline', 'CalendarSearch', 'Regex', 'Dribbble', 'AirVent', 'InspectionPanel', 'MapPin', 'EqualNot', 'MonitorDot', 'CalendarArrowDown', 'Receipt', 'ArrowBigRight', 'ArrowUp', 'BatteryMedium', 'Cloudy', 'X', 'FoldHorizontal', 'MailQuestion', 'EarOff', 'SquareMinus', 'TestTubeDiagonal', 'PanelRight'
        ];

        const matchingIconNames = iconNames.filter((name) => name.toLowerCase().includes(searchTerm.toLowerCase()));

        const loadedIcons = await Promise.all(
          matchingIconNames.map((name) =>
            import(`lucide-react`)
              .then((module) => ({ name, Icon: module[name] }))
              .catch(() => ({ name, Icon: null }))
        ));

        // Filter out icons that failed to load (Icon will be null)
        setDynamicIcons(loadedIcons.filter(({ Icon }) => Icon));
      } catch (error) {
        console.error("Error loading icons dynamically:", error);
      }
    } else {
      setDynamicIcons([]); // Clear dynamic icons when search term is empty
    }
  }, []);

  // Combine famous icons and dynamically loaded icons
  const iconList = useMemo(() => {
    const filteredFamousIcons = famousIcons.filter(({ name }) =>
      name.toLowerCase().includes(search.toLowerCase())
    );

    return [...filteredFamousIcons, ...dynamicIcons]; // Combine static and dynamic icons
  }, [search, dynamicIcons]);

  const handleSearchChange = (e: React.ChangeEvent<HTMLInputElement>) => {
    const newSearch = e.target.value;
    setSearch(newSearch);
    setDynamicIcons([]); // Clear dynamic icons on new search
    loadDynamicIcons(newSearch); // Load dynamic icons based on new search
  };

  return (
    <div className="space-y-4">
      {/* Search Input */}
      <Input
        type="search"
        placeholder="Search icons..."
        value={search}
        onChange={handleSearchChange}
        className="w-full p-2 border rounded-md"
      />

      {/* Scrollable Icon Grid */}
      <ScrollArea className="h-[400px]">
        <div className="grid grid-cols-4 gap-4">
          {iconList.length > 0 ? (
            iconList.map(({ name, Icon }) => (
              <button
                key={name}
                className="p-2 rounded-lg hover:bg-accent flex flex-col items-center gap-1"
                onClick={() => updateState({ selectedIcon: Icon })}
                aria-label={`Select ${name} icon`} // Added aria-label for accessibility
              >
                {/* Render Icon */}
                {Icon ? <Icon size={24} /> : <span>Icon not found</span>} {/* Handle undefined icons */}
                <span className="text-xs text-muted-foreground truncate w-full text-center">
                  {name}
                </span>
              </button>
            ))
          ) : (
            <p className="text-center col-span-4 text-muted-foreground">
              No icons found
            </p>
          )}
        </div>
      </ScrollArea>
    </div>
  );
}
